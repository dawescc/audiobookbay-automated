{% extends "base.html" %} {% block title %}Torrent Status{% endblock %} {% block content %}
<table class="status">
	<thead>
		<tr>
			<th>Title</th>
			<th>Progress</th>
			<th>State</th>
			<th>Size</th>
			<th>Action</th>
		</tr>
	</thead>
	<tbody>
		{% for torrent in torrents %}
		<tr>
			<td>{{ torrent.name }}</td>
			<td>{{ torrent.progress }}%</td>
			<td>{{ torrent.state }}</td>
			<td>{{ torrent.size }}</td>
			<td>
				<button
					class="remove-button"
					onclick="deleteTorrent('{{ torrent.id }}')">
					Remove
				</button>
			</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
<script>
	function deleteTorrent(torrentId) {
		if (!confirm("Are you sure you want to remove this torrent? The downloaded files will NOT be deleted.")) {
			return;
		}

		fetch("/delete", {
			method: "POST",
			headers: {
				"Content-Type": "application/json",
			},
			body: JSON.stringify({ id: torrentId }),
		})
			.then((response) => response.json())
			.then((data) => {
				alert(data.message);
				if (data.message.includes("successfully")) {
					location.reload();
				}
			})
			.catch((error) => {
				console.error("Error:", error);
				alert("An error occurred.");
			});
	}
</script>
{% endblock %}
